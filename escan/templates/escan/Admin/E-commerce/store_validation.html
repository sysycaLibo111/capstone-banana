{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="{% static 'assets/LogoW.png' %}" type="image/png">
    <title>Store Validation</title>
    <!-- External Resources -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
 <style>
      /* ========== ROOT VARIABLES ========== */
      :root {
        --dark-brown: #2f1609;
        --medium-brown: #704210;
        --light-brown: #96500e;
        --gold: #da9408;
        --light-gold: #fbd576;
        --bright-gold: #fbd242;
        --white: #ffffff;
        --light-bg: #fff9ec;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --shadow-sm: 0 2px 5px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 5px 15px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 8px 25px rgba(218, 148, 8, 0.15);
        --success-green: #28a745;
        --success-green-hover: #218838;
      }

      /* ========== BASE STYLES ========== */
      * {
        box-sizing: border-box;
      }
      
      body {
        font-family: "Poppins", sans-serif;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        background-color: var(--light-bg);
        color: var(--dark-brown);
        min-height: 100vh;
      }

      /* Sidebar Styles */
      nav.sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 280px;
        height: 100%;
        background: linear-gradient(
          to bottom,
          var(--medium-brown),
          var(--light-brown)
        );
        padding: 20px 0;
        display: flex;
        flex-direction: column;
        gap: 15px;
        z-index: 1000;
        transition: all 0.3s ease;
        box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
        overflow-y: auto;
      }

      .logo-container {
        text-align: center;
        padding: 0 20px 20px;
        border-bottom: 1px solid rgba(251, 210, 66, 0.3);
        transition: var(--transition);
      }

      .logo {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        border: 3px solid var(--bright-gold);
        object-fit: cover;
        transition: all 0.3s ease;
      }

      .logo:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px var(--bright-gold);
      }

      nav .menu {
        display: flex;
        flex-direction: column;
        gap: 5px;
        padding: 0 15px;
        margin-top: 20px;
      }

      nav .menu a {
        color: var(--light-gold);
        text-decoration: none;
        font-size: 20px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px 20px;
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      nav .menu a:hover {
        background: linear-gradient(to right, var(--gold), transparent);
        color: var(--white);
        transform: translateX(5px);
      }

      nav .menu a.active {
        background: linear-gradient(to right, var(--gold), transparent);
        color: var(--white);
        transform: translateX(5px);
      }

      nav .menu a i {
        width: 24px;
        text-align: center;
        font-size: 20px;
        transition: var(--transition);
      }

      /* Burger Menu Styles */
      .burger {
        display: none;
        cursor: pointer;
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1100;
        background-color: var(--gold);
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        flex-direction: column;
        justify-content: space-around;
        width: 40px;
        height: 40px;
        transition: all 0.3s linear;
      }

      .burger-line {
        width: 100%;
        height: 3px;
        background-color: var(--white);
        border-radius: 10px;
        transition: all 0.3s ease;
        transform-origin: center;
      }

      .burger.active {
        left: 260px;
        background-color: var(--light-brown);
      }

      .burger.active .burger-line:nth-child(1) {
        transform: rotate(45deg) translate(8px, 8px);
      }

      .burger.active .burger-line:nth-child(2) {
        opacity: 0;
        transform: translateX(20px);
      }

      .burger.active .burger-line:nth-child(3) {
        transform: rotate(-45deg) translate(8px, -8px);
      }

      .content {
        margin-left: 280px;
        padding: 25px;
        transition: all 0.3s;
        min-height: 100vh;
      }

      /* ========== NAVIGATION BAR ========== */
      .nav-bar {
        background-color: var(--white);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
        margin-bottom: 25px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
        position: sticky;
        top: 15px;
        z-index: 100;
      }

      .page-title {
        font-size: 25px;
        font-weight: 600;
        color: var(--medium-brown);
        margin: 0;
        position: relative;
      }
      .page-title::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 50px;
        height: 3px;
        background: linear-gradient(to right, var(--gold), var(--bright-gold));
      }

      .v-container {
        display: flex;
        align-items: center;
        gap: 25px;
      }

      .v-icon:hover {
        color: var(--gold);
        transform: scale(1.1);
      }

    

      .icons {
        display: flex;
        gap: 20px;
        font-size: 25px;
      }

      .notification-icon,
      .settings-icon {
        cursor: pointer;
        color: var(--medium-brown);
        transition: var(--transition);
      }

      .notification-icon:hover,
      .settings-icon:hover {
        color: var(--gold);
        transform: scale(1.1);
      }

      /* ========== SETTINGS DROPDOWN ========== */
      .settings-dropdown {
        display: none;
        position: absolute;
        right: 0;
        top: 120%;
        background-color: var(--white);
        border-radius: 8px;
        box-shadow: var(--shadow-md);
        z-index: 1000;
        width: 220px;
        overflow: hidden;
      }

      .settings-item {
        padding: 10px 15px;
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--dark-brown);
        text-decoration: none;
        transition: var(--transition);
      }

      .settings-item:hover {
        background-color: var(--light-bg);
        color: var(--gold);
      }

      .settings-item i {
        width: 20px;
        text-align: center;
      }

      .dropdown-footer {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }

      /* ========== TOAST NOTIFICATION ========== */
      .toast-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background: var(--gold);
        color: var(--white);
        border-radius: 8px;
        box-shadow: var(--shadow-md);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
        animation: fadeIn 0.5s, fadeOut 0.5s 2.5s forwards;
        transform: translateX(0);
      }

      /* ========== TABLE STYLES ========== */
      .table-container {
        background-color: var(--white);
        border-radius: 12px;
        box-shadow: var(--shadow-sm);
        overflow: hidden;
        padding: 20px;
        width: 100%;
      }

      .table-responsive {
        overflow-x: auto;
        width: 100%;
      }

      .table {
        width: 100%;
        border-collapse: collapse;
      }

      .table th {
        background-color: var(--medium-brown);
        color: var(--white);
        font-weight: 500;
        padding: 12px 15px;
        text-align: left;
      }

      .table td {
        padding: 12px 15px;
        vertical-align: middle;
        border-top: 1px solid #dee2e6;
      }

      .badge {
        font-size: 0.85em;
        padding: 5px 10px;
        border-radius: 20px;
      }

      /* Green View Button */
      .btn-view {
        background-color: var(--success-green);
        border-color: var(--success-green);
        color: white;
        border: none;
        border-radius: 4px;
        padding: 6px 12px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .btn-view:hover {
        background-color: var(--success-green-hover);
        border-color: var(--success-green-hover);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      }

      /* ========== MODAL STYLES ========== */
      .modal-content {
        border-radius: 16px;
        border: none;
        box-shadow: var(--shadow-lg);
        overflow: hidden;
      }

      .modal-header {
        background: linear-gradient(135deg, var(--gold), var(--bright-gold));
        color: var(--white);
        border-bottom: none;
        padding: 20px;
        position: relative;
      }

      .modal-title {
        font-weight: 600;
        font-size: 1.5rem;
      }

      .btn-close {
        filter: invert(1);
        position: absolute;
        right: 20px;
        top: 20px;
      }

      .modal-body {
        padding: 25px;
      }

      .info-group {
        margin-bottom: 15px;
      }

      .info-label {
        font-weight: 600;
        color: var(--medium-brown);
        margin-bottom: 5px;
        font-size: 14px;
      }

      .info-value {
        color: var(--dark-brown);
        font-size: 16px;
      }

      .id-picture-container {
        text-align: center;
        margin: 20px 0;
      }

      .id-picture {
        max-width: 100%;
        max-height: 200px;
        border-radius: 12px;
        box-shadow: var(--shadow-md);
        border: 1px solid var(--light-gold);
        object-fit: contain;
      }

      .modal-footer {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        padding: 20px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      /* ========== ANIMATIONS ========== */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateX(100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }

      /* ========== RESPONSIVE STYLES ========== */
      /* Large devices (desktops, 1200px and up) */
      @media (min-width: 1200px) {
        .container-lg {
          max-width: 1140px;
        }
      }

      /* Medium devices (tablets, 992px to 1199px) */
      @media (max-width: 1199px) {
        nav.sidebar {
          width: 250px;
        }
        .content {
          margin-left: 250px;
        }
        
        .logo {
          width: 100px;
          height: 100px;
        }
        .settings-icon{
          font-size: 20px;
        }
        
        nav .menu a {
          font-size: 18px;
          padding: 10px 15px;
        }
      }

      /* Small devices (landscape phones, 768px to 991px) */
      @media (max-width: 991px) {
        nav.sidebar {
          width: 80px;
        }

        .content {
          margin-left: 50px;
          padding: 20px;
        }
        
        /* Hide text in sidebar, show only icons */
        nav.sidebar .menu a span {
          display: none;
        }
        
        nav.sidebar .menu a {
          justify-content: center;
          padding: 15px;
        }
        
        nav.sidebar .menu a i {
          font-size: 24px;
          margin-right: 0;
        }
        
        .logo-container {
          padding: 0 15px 15px;
        }
        
        .logo {
          width: 50px;
          height: 50px;
          justify-content: start;
        }
        
        .page-title {
          font-size: 22px;
        }
        
        .table th, .table td {
          padding: 10px 12px;
        }
      }

      /* Mobile Styles (767px and below) */
      @media (max-width: 767px) {
        nav.sidebar {
          width: 50px;
        }

        
        nav.sidebar.active {
          transform: translateX(0);
          width: 260px;
        }
        
        .logo-container {
          padding: 0 5px 10px;
          border-bottom: 1px solid rgba(251, 210, 66, 0.2);
        }
        
        .logo {
          width: 40px;
          height: 40px;
          border-width: 2px;
        }
        
        nav .menu {
          padding: 0 5px;
          gap: 2px;
        }
        
        nav .menu a {
          padding: 10px;
          justify-content: center;
        }
        
        nav .menu a i {
          font-size: 18px;
          margin: 0;
        }
        
        /* Show text when sidebar is active */
        nav.sidebar.active .menu a span {
          display: inline-block;
        }
        
        nav.sidebar.active .menu a {
          justify-content: flex-start;
          padding: 12px 15px;
        }
        
        nav.sidebar.active .menu a i {
          margin-right: 15px;
          font-size: 20px;
        }
        
        nav.sidebar.active .logo {
          width: 80px;
          height: 80px;
        }
        
        .content {
          margin-left: 50px;
        
        }
        
        .burger {
          display: flex;
          left: 15px;
          top: 15px;
          padding: 8px;
        }
        
        .burger.active {
          left: 260px;
        }
        
        .nav-bar {
          position: sticky;
          top: 10px;
          padding: 15px;
          margin-top: 10px;
        }
        
        .page-title {
          font-size: 20px;
        }
        
        .page-title::after {
          width: 40px;
        }
        
        .table th, .table td {
          padding: 8px 10px;
          font-size: 14px;
        }
        
        .badge {
          font-size: 0.75em;
          padding: 4px 8px;
        }
        
        /* Make view button smaller on mobile */
        .btn-view {
          padding: 4px 8px;
          font-size: 12px;
        }
        
        .icons {
          gap: 15px;
          font-size: 20px;
        }
        .settings-icon{
          font-size: 20px;
        }
        
        .modal-dialog {
          margin: 20px;
        }
        
        .modal-header {
          padding: 15px;
        }
        
        .modal-body {
          padding: 20px;
        }
        
        .modal-footer {
          padding: 15px;
        }
      }

      /* Extra small devices (phones, 575px and below) */
      @media (max-width: 575px) {
         nav.sidebar {
          width: 50px;
        }

        nav .menu a i {
        width: 24px;
        text-align: center;
        font-size: 15px;
        transition: var(--transition);
      }
        .nav-bar {
          width: 100%;
          height: 50px;
          position: sticky;
        }
        
        .v-container {
          width: 10%;
          justify-content: space-between;
        }
        .settings-icon{
          font-size: 15px;
        }
        
        .table th:nth-child(5),
        .table td:nth-child(5),
        .table th:nth-child(6),
        .table td:nth-child(6) {
          display: none;
        }
        
        .modal-dialog {
          margin: 10px;
        }
        
        .page-title {
          font-size: 15px;
        }
        
        /* Further reduce sidebar size on very small screens */
        nav.sidebar {
          width: 45px;
        }
        
        nav.sidebar.active {
          width: 100%;
        }
        
        .content {
          padding: 10px;
        }
        
        .burger {
          left: 10px;
          top: 10px;
        }
        
        .burger.active {
          left: calc(100% - 50px);
        }

        .modal-body{
          height: 800px;
          width: 80px;
        }
      }

      /* Super small devices (phones, 400px and below) */
      @media (max-width: 400px) {
          nav.sidebar {
          width: 50px;
        }

         nav .menu a i {
        width: 24px;
        text-align: center;
        font-size: 13px;
        transition: var(--transition);
      }
        .page-title{
          font-size: 15px;
        }
        .icons{
          font-size: 13px;
        }
        .settings-icon{
          font-size: 13px;
        }
        .table th:nth-child(5),
        .table td:nth-child(5),
        .table th:nth-child(6),
        .table td:nth-child(6) {
          display: none;
        }
        
        .modal-body {
          padding: 15px;
        }
        
        .modal-footer {
          padding: 15px;
          flex-direction: column;
        }
        
        .modal-footer .btn {
          width: 100%;
          margin-bottom: 5px;
        }
        
        .info-label {
          font-size: 13px;
        }
        
        .info-value {
          font-size: 14px;
        }
        
        .id-picture {
          max-height: 150px;
        }
        
        .settings-dropdown {
          width: 180px;
        }
      }
    </style>
  </head>
  <body>
    <nav class="sidebar">
      <div class="logo-container">
        <img src="{% static 'img/LogoW.png' %}" alt="Logo" class="logo" />
      </div>
      <div class="menu">
        <a href="{% url 'admin_dashboard' %}"
          ><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a
        >
        <a href="{% url 'product_list' %}"
          ><i class="fas fa-store-alt"></i> <span>My Store</span></a
        >
        <a href="{% url 'a_market_place' %}"
          ><i class="fas fa-store"></i> <span>Market Place</span></a
        >
        <a href="{% url 'validation_list' %}" class="active"
          ><i class="fas fa-briefcase"></i> <span>Store Applicants</span></a
        >
        <a href="{% url 'orders_part' %}"
          ><i class="fas fa-shopping-cart"></i> <span>Orders</span></a
        >
        <a href="{% url 'customer_table' %}"
          ><i class="bi bi-people-fill"></i> <span>Customers</span></a
        >
        <a href="{% url 'a_scan' %}"><i class="fas fa-qrcode"></i> <span>Scan</span></a
        >
        <a href="{% url 'a_scan' %}#knowledge-section"
          ><i class="fas fa-book-reader"></i> <span>Library</span></a
        >
        <a href="#"><i class="fas fa-file-alt"></i> <span>History</span></a
        >
      </div>
    </nav>

    <!-- ========== MAIN CONTENT ========== -->
    <div class="content">
      <!-- ========== NAVIGATION BAR ========== -->
      <div class="nav-bar">
        <div class="page-title">STORE APPLICANTS</div>

        <div class="v-container">
          <div class="icons">
            <div class="notification-icon" onclick="toggleNotifications()">
              <i class="fas fa-bell"></i>
            </div>
          </div>
          <div class="settings-icon" id="settings-icon">
            <i class="fas fa-cog" style="font-size: 25px"></i>
            <div class="settings-dropdown">
               <a href="#" class="settings-item" data-bs-toggle="modal" data-bs-target="#profileModal"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" class="settings-item" data-bs-toggle="modal" data-bs-target="#ShippingModal"><i class="fas fa-map-marker-alt"></i> Address Details</a>
                            <div class="dropdown-footer">
                                <a href="{% url 'logout' %}" class="settings-item" style="color: #EF4444;">
                                    <i class="fas fa-sign-out-alt"></i> Logout
                                </a>
                            </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ========== STORE VALIDATION TABLE ========== -->
      <div class="table-container">
        <div class="table-responsive">
          <table class="table table-bordered table-hover">
            <thead>
              <tr>
                <th>Full Name</th>
                <th>Phone</th>
                <th>Location</th>
                <th>Status</th>
                <th>Reviewed By</th>
                <th>Reviewed At</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for v in validations %}
              <tr>
                <td>{{ v.first_name }} {{ v.last_name }}</td>
                <td>{{ v.phone_number }}</td>
                <td>{{ v.address }}, {{ v.city }}, {{ v.province }}</td>
                <td>
                  {% if v.status == 'pending' %}
                    <span class="badge bg-warning text-dark">Pending</span>
                  {% elif v.status == 'approved' %}
                    <span class="badge bg-success">Approved</span>
                  {% else %}
                    <span class="badge bg-danger">Rejected</span>
                    {% if v.rejection_reason %}
                    <div class="block text-muted mt-2" style="font-size: 14px;">
                      Reason: {{ v.rejection_reason }}
                    </div>
                    {% endif %}
                  {% endif %}
                </td>
                <td>{{ v.reviewed_by }}</td>
                <td>{{ v.reviewed_at|date:"M d, Y H:i" }}</td>
                <td>
                  <!-- View Button triggers modal -->
                  <button type="button" class="btn btn-sm btn-view mb-1"
                          data-bs-toggle="modal" 
                          data-bs-target="#viewModal{{ v.id }}">
                    View
                  </button>
                </td>
              </tr>

              <!-- Modal (one per row) -->
              <div class="modal fade" id="viewModal{{ v.id }}" tabindex="-1" aria-labelledby="viewModalLabel{{ v.id }}" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                  <div class="modal-content">
                    <form method="POST" action="{% url 'update_validation_status' v.id %}">
                      {% csrf_token %}
                      <div class="modal-header">
                        <h6 class="modal-title" id="viewModalLabel{{ v.id }}">Application Review</h6>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>

                      <div class="modal-body">
                        <div class="info-group">
                          <div class="info-label">Name</div>
                          <div class="info-value">{{ v.first_name }} {{ v.last_name }}</div>
                        </div>
                        
                        <div class="info-group">
                          <div class="info-label">Phone</div>
                          <div class="info-value">{{ v.phone_number }}</div>
                        </div>
                        
                        <div class="info-group">
                          <div class="info-label">Street/Barangay</div>
                          <div class="info-value">{{ v.address }}</div>
                        </div>
                        
                        <div class="info-group">
                          <div class="info-label">City</div>
                          <div class="info-value">{{ v.city }}</div>
                        </div>
                        
                        <div class="info-group">
                          <div class="info-label">Province</div>
                          <div class="info-value">{{ v.province }}</div>
                        </div>
                        
                        <div class="info-group">
                          <div class="info-label">Status</div>
                          <div class="info-value">{{ v.get_status_display }}</div>
                        </div>
                        
                        <div class="info-group">
                          <div class="info-label">Submitted At</div>
                          <div class="info-value">{{ v.created_at|date:"M d, Y H:i" }}</div>
                        </div>

                        {% if v.id_picture %}
                          <div class="id-picture-container">
                            <div class="info-label">ID Picture</div>
                            <img src="{{ v.id_picture }}" alt="ID Picture" class="id-picture">
                          </div>
                        {% endif %}

                        <div class="mb-3 mt-4">
                          <label for="reason{{ v.id }}" class="form-label info-label">Rejection Reason (if rejecting)</label>
                          <textarea name="reason" id="reason{{ v.id }}" 
                                    class="form-control" 
                                    placeholder="Enter reason for rejection..."
                                    rows="3"></textarea>
                        </div>
                      </div>

                      <div class="modal-footer">
                        <button type="submit" name="status" value="approved" class="btn btn-success">Approve</button>
                        <button type="submit" name="status" value="rejected" class="btn btn-danger" data-requires-reason="true">Reject</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>

              {% empty %}
              <tr>
                <td colspan="7" class="text-center py-4">No applications found.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // ========== TOAST NOTIFICATION FUNCTION ==========
        function showToast(message, type) {
          const toast = document.createElement("div");
          toast.className = "toast-notification";

          const icon =
            type === "success"
              ? "fa-check-circle"
              : type === "error"
              ? "fa-exclamation-circle"
              : "fa-info-circle";
          toast.innerHTML = `
                    <i class="fas ${icon}"></i>
                    <span>${message}</span>
                `;

          if (type === "error") {
            toast.style.background = "#EF4444";
          } else if (type === "success") {
            toast.style.background = "#28a745";
          }

          document.body.appendChild(toast);

          // Remove toast after animation
          setTimeout(() => toast.remove(), 3000);
        }

        // ========== SIDEBAR TOGGLE ==========
        function toggleNav() {
          const sidebar = document.querySelector(".sidebar");
          const burger = document.getElementById("burger");
          sidebar.classList.toggle("active");
          burger.classList.toggle("active");
        }

        // Close sidebar when clicking outside (mobile only)
        document.addEventListener("click", function (event) {
          const sidebar = document.querySelector(".sidebar");
          const burger = document.getElementById("burger");

          if (
            !sidebar.contains(event.target) &&
            !burger.contains(event.target) &&
            window.innerWidth <= 768 &&
            sidebar.classList.contains("active")
          ) {
            sidebar.classList.remove("active");
            burger.classList.remove("active");
          }
        });

        // ========== SETTINGS DROPDOWN ==========
        const settingsIcon = document.getElementById("settings-icon");
        if (settingsIcon) {
          settingsIcon.addEventListener("click", function (e) {
            e.stopPropagation();
            const dropdown = this.querySelector(".settings-dropdown");
            dropdown.style.display =
              dropdown.style.display === "block" ? "none" : "block";
          });

          // Prevent dropdown from closing when clicking inside
          document
            .querySelector(".settings-dropdown")
            .addEventListener("click", function (e) {
              e.stopPropagation();
            });
        }

        // Close dropdowns when clicking outside
        window.addEventListener("click", function () {
          const dropdown = document.querySelector(".settings-dropdown");
          if (dropdown) {
            dropdown.style.display = "none";
          }
        });

        // ========== NOTIFICATIONS ==========
        function toggleNotifications() {
          showToast("Notifications feature would be implemented here", "info");
        }

        // ========== REJECT BUTTON VALIDATION ==========
        // reject button disabled by default
        document.querySelectorAll("textarea[name='reason']").forEach(function(textarea) {
            const rejectBtn = textarea.closest(".modal-content").querySelector("button[value='rejected']");
            
            if (rejectBtn) {
            rejectBtn.disabled = true;
            textarea.addEventListener("input", function() {
                rejectBtn.disabled = (this.value.trim() === "");
            });
            }
        });

        document.querySelectorAll('[data-requires-reason="true"]').forEach(function (btn) {
          btn.addEventListener("click", function (e) {
            const form = e.target.closest("form");
            const reason = form.querySelector('textarea[name="reason"]');
            if (!reason || reason.value.trim() === "") {
              e.preventDefault();
              showToast("Please enter a rejection reason before rejecting.", "error");
            }
          });
        });

        // Auto-adjust sidebar based on screen size
        function handleSidebar() {
          const sidebar = document.querySelector(".sidebar");
          const burger = document.getElementById("burger");
          
          if (window.innerWidth <= 768) {
            // Mobile view - collapsed sidebar
            if (!sidebar.classList.contains("active")) {
              sidebar.style.width = "50px";
            }
            burger.style.display = "block";
          } else if (window.innerWidth <= 992) {
            // Medium screens - show icons only
            sidebar.classList.add("active");
            burger.style.display = "none";
          } else {
            // Large screens - show full sidebar
            sidebar.classList.add("active");
            burger.style.display = "none";
          }
        }

        // Initial call and on resize
        handleSidebar();
        window.addEventListener('resize', handleSidebar);
      });
    </script>
  </body>
</html>